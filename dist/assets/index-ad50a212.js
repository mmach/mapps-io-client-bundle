import{L as B,N as T,a as p,O as h,U as y,R as s,M as r,j as n,a3 as G,l as P,ai as w,ak as j,G as k,am as N,Y as D,X as L,V as O,Z as z,W as M}from"./index-1a5b9518.js";import{d as $}from"./Extension-feb01109.js";import"./createSvgIcon-51564d9c.js";const q=({type:e})=>({columns:[{titleToken:"CREATED AT",field:"createdAt",type:"date",isActive:!0},{titleToken:"GROUP",field:"group",isActive:!0},{titleToken:"TOKEN",field:"token",isActive:!0},{titleToken:"CMS PARENT",field:"cms_element_id",isActive:!0},{titleToken:"ACTIVATE",field:"is_active",isActive:!0,type:"checkbox"},{titleToken:"IS_PREDEFINED",field:"project_id",isActive:!0,type:"!checkbox"}],enableGrouping:!0}),b=e=>{const o={getCmsElementAdmin:()=>e(new h().queryThunt("getCmsElementAdminQuery",{})),getProjectCmsElement:()=>e(new h().queryThunt("getProjectCmsElementQuery",{})),deleteCmsElement:t=>e(new h().commandThunt("deleteCmsElementCommand",t)),deleteProjectCmsElement:t=>e(new h().commandThunt("deleteProjectCmsElementCommand",t)),upsertCmsElement:t=>e(new h().commandThunt("upsertCmsElementCommand",t)),upsertProjectCmsElement:t=>e(new h().commandThunt("upsertProjectCmsElementCommand",t))};return{...o,upsertProjectCmsElement:async t=>{await o.upsertProjectCmsElement(t),await o.getCmsElementAdmin()},deleteProjectCmsElement:async t=>{await o.deleteProjectCmsElement(t),await o.getCmsElementAdmin()}}},H=e=>o=>e?o.CmsElementsAdminReducer.cms.find(t=>t.id==e):null;function x(){const e=B(),{cmsElementsAdminReducer:o}=T(f=>({cmsElementsAdminReducer:f.CmsElementsAdminReducer})),[t,a]=p.useState(),u=T(H(t)),l=p.useCallback(b(e).getCmsElementAdmin,[e]),m=p.useCallback(b(e).getProjectCmsElement,[e]),i=p.useCallback(b(e).deleteCmsElement,[e]),g=p.useCallback(b(e).deleteProjectCmsElement,[e]),d=p.useCallback(b(e).upsertCmsElement,[e]),C=p.useCallback(b(e).upsertProjectCmsElement,[e]);return{selectors:{cmsElementsAdminReducer:o,getCmsElementIdReducer:u},actions:{getCmsElementAdmin:l,getProjectCmsElement:m,deleteCmsElement:i,deleteProjectCmsElement:g,upsertCmsElement:d,upsertProjectCmsElement:C},state:{cmsElementId:t},hooks:{setCmsElementId:a},functions:{}}}function J({cmsElement:e,setCmsElement:o}){const{translate:t,getLabel:a}=y(),u=s.useMemo(r().Layouts.Sections.V1),[l,m]=s.useState({...e});return s.useEffect(()=>{o(l)},[l]),n(G,{children:P(u,{title:"Cms Element",children:[n(w,{label:t(a,"Token"),value:l.token,onChange:i=>{m({...l,token:i.target.value})},field:"order",validation:[]}),n(j,{label:t(a,"Load on init"),value:l.load_on_init,onChange:i=>{m({...l,load_on_init:i.target.checked})},field:"load_on_init",validation:[]}),n(j,{label:t(a,"Is Active"),value:l.is_active,onChange:i=>{m({...l,is_active:i.target.checked})},field:"is_active",validation:[]})]})})}function Q({cmsElement:e,setCmsElement:o}){const t=s.useMemo(r().Layouts.Tab.V1),[a,u]=s.useState({...e});return s.useEffect(()=>{o(a)},[a]),n(k,{container:!0,children:n(t,{defaultTab:0,tabConfig:[{label:"CMS Json",render:()=>n(N,{mode:"json",theme:"monokai",value:a.cms,onChange:l=>{u({...a,cms:l})},padding:10,style:{fontFamily:'"Fira code", "Fira Mono", monospace',fontSize:12,width:"100%",height:"80vh"},showPrintMargin:!0,showGutter:!0,highlightActiveLine:!0,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2}},1)}]})})}function _({cmsElementId:e}){const o=s.useMemo(r().ButtonLoader),t=s.useMemo(r().Layouts.Groups.V1),a=s.useMemo(r().Layouts.Tab.V1),u=D(),{translate:l,getLabel:m}=y(),[i,g]=s.useState(!0),[d,C]=s.useState({}),{selectors:{getCmsElementIdReducer:f},actions:{upsertProjectCmsElement:v},hooks:{setCmsElementId:S}}=x();s.useEffect(()=>{e?S(e):(C({id:L()}),g(!1))},[]),s.useEffect(()=>{f&&(C(f),g(!1))},[f]);async function A(){await v(d),u.actions.closeDrawer()}return!i&&P(k,{container:!0,children:[n(t,{xs:12,sm:6,title:"CMS Element Details",children:n(w,{label:l(m,"Token"),value:d.token,field:"order",disabled:!0,validation:[]})}),n(a,{defaultTab:0,tabConfig:[{label:"Details",render:()=>n(J,{cmsElement:{...d},setCmsElement:C})},{label:"CMS JSON",render:()=>n(Q,{cmsElement:{...d},setCmsElement:C})}]}),n(k,{style:{marginLeft:"1rem",marginBottom:"1rem"},children:n(o,{color:"primary",onClick:A,value:l(m,"Save"),variant:"outlined"})})]})}function W(){const e=s.useMemo(r().ConfirmationDialog),[o,t]=s.useState(!0),a=s.useMemo(r().Layouts.Table.V2),u=s.useMemo(r().Layouts.Containers.V1);s.useMemo(r().Layouts.Tab.V1);const l=s.useMemo(r().ButtonLoader),{actions:m}=D(),i=O(),{translate:g,getLabel:d}=y(),{selectors:{cmsElementsAdminReducer:C},actions:{getCmsElementAdmin:f,upsertProjectCmsElement:v,deleteProjectCmsElement:S,deleteCmsElement:A}}=x();s.useEffect(()=>{t(!0),Promise.all([f()]).then(E=>{t(!1)})},[]);function R(){m.openDrawer(!0,n(k,{style:{width:"50vw",display:"flex"},children:n(_,{})}),"right")}function F(E,c){m.openDrawer(!0,n(k,{style:{width:"50vw",display:"flex"},children:n(_,{cmsElementId:c.id})}),"right")}function I(E,c){i.actions.openDialog(!0,n(e,{title:"Duplicate CMS Element",description:`Do you want to duplicate ${c.token} element?`,onConfirm:async()=>{i.actions.closeDialog(),t(!0),await v({...c,id:L(),token:c.token+"- COPY",cms_element_id:c.cms_element_id||c.id}),t(!1)}}))}function V(E,c){i.actions.openDialog(!0,n(e,{title:"Delete CMS Element",description:`Do you want to delete ${c.token} element?`,onConfirm:async()=>{i.actions.closeDialog(),t(!0),await S(c),t(!1)}}))}return n(k,{container:!0,style:{justifyContent:"center"},children:n(u,{title:"CMS Elements",icon:n($,{}),xs:12,sm:12,children:n(a,{freeActions:[n(l,{size:"small",value:g(d,"Create CMS Element"),variant:"outlined",onClick:R,startIcon:n(z,{})},1)],isLoading:o,title:"Manage CMS Elements",pageSize:20,...q({}),data:C.cms||[],actions:[E=>({icon:M.Edit,label:"Edit CMS Element",onClick:F,hidden:!E.project_id}),E=>({icon:M.Delete,label:"Delete CMS Element",onClick:V,hidden:!E.project_id}),E=>({icon:M.Save,label:"Duplicate CMS Element",onClick:I})]})})})}export{W as default};
