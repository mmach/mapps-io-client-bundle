var B=Object.defineProperty;var c=(l,r)=>B(l,"name",{value:r,configurable:!0});import{R as o,q as j,d as O,w as x,x as V,M as f,y as z,u as G,e as n,G as I,T as m,D as Y,F as $,z as q,A as J}from"./index-1e2236a6.js";function H({asAdmin:l,tableConfig:r,withDate:s=!0,openIuaCms:g="DEFAULT"}){const[y,v]=o.useState(!0),[d,F]=o.useState(new Date),[b,S]=o.useState([]),L=r||q,p=j({}),M=O(),h=x(),_=V(),w=o.useMemo(f().Layouts.Table.V2),A=o.useMemo(f().IUA.PREVIEW.DEFAULT),C=o.useMemo(f().BodyLoader),u=z(),{translate:D,getLabel:E}=G();o.useEffect(()=>()=>u.actions.clean(),[]),o.useEffect(()=>{v(!0),u.actions.getInvoices({year:s?d.getFullYear():void 0,month:s?d.getMonth():void 0,size:s?100:1e5,page:0,asAdmin:l}).then(e=>{const t=e.data.filter(a=>!p.selectors.iuaReducer.iuaRelations[a.iua.id]).map(a=>a.iua.id);if(v(!1),t.length>0)return p.actions.getIuaList(t)}).then(e=>{if(e&&e.data){const t=[...new Set(e.data.map(a=>a.category_id))];_.hooks.setCategoryIds(t)}})},[d]),o.useEffect(()=>{S([...u.selectors.InvoicesReducer.invoices])},[u.selectors.InvoicesReducer.invoices]);function R(e){const t=e;window.scrollTo(0,0),F(t)}c(R,"onDateChange");function T(e,t){console.log(t),h.actions.openDrawer(!0,n(I,{container:!0,style:{width:1100},children:n(A,{iua_id:t.iua.parent_iua_id,cmsMode:g,device:"desktop"})}),"right")}c(T,"clickItem");function k(e,t){const a=t.id,i=b.filter(U=>U.id==a)[0],P={pdf_id:i.blob.blob_id,subject:D(E,"SEND_MAIL_SUBJECT",i.number_string,i.month+"/"+i.year),body:`${window.env.BLOB_URL}/blob/${i.blob.blob_id}.pdf`};M.actions.openModal(!0,n(J,{...P}))}return c(k,"openInvoice"),y?n(C,{}):n(I,{container:!0,style:{justifyContent:"center"},children:n(w,{icons:m,freeActions:[s?n(Y,{variant:"month",label:"Month",dateFormat:"MM/yyyy",showMonthYearPicker:!0,value:d,onChange:R}):n($,{})],...L({}),actions:[()=>({icon:m.OpenIn,label:"Open IUA",onClick:T}),()=>({icon:m.PictureAsPdf,label:"Open Invoice",onClick:k})],data:b.sort((e,t)=>new Date(t.createdAt)>new Date(e.createdAt)?1:-1).map(e=>({...e,info:{number:e.number}})),title:"Invoices List"})})}c(H,"InvoicesList");export{H as default};
