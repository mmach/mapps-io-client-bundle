var U=Object.defineProperty;var c=(l,r)=>U(l,"name",{value:r,configurable:!0});import{R as o,q as j,d as O,w as x,x as B,M as p,y as V,u as z,e as a,G as I,T as f,D as G,F as Y,z as $,A as q}from"./index-3f4d4c10.js";function W({asAdmin:l,tableConfig:r,withDate:s=!0,openIuaCms:g="DEFAULT"}){const[F,v]=o.useState(!0),[d,S]=o.useState(new Date),[b,y]=o.useState([]),L=r||$,m=j({}),M=O(),h=x(),_=B(),w=o.useMemo(p().Layouts.Table.V2),A=o.useMemo(p().IUA.PREVIEW.DEFAULT),u=V(),{translate:C,getLabel:D}=z();o.useEffect(()=>()=>u.actions.clean(),[]),o.useEffect(()=>{v(!0),u.actions.getInvoices({year:s?d.getFullYear():void 0,month:s?d.getMonth():void 0,size:s?100:1e5,page:0,asAdmin:l}).then(e=>{const t=e.data.filter(n=>!m.selectors.iuaReducer.iuaRelations[n.iua.id]).map(n=>n.iua.id);if(v(!1),t.length>0)return m.actions.getIuaList(t)}).then(e=>{if(e&&e.data){const t=[...new Set(e.data.map(n=>n.category_id))];_.hooks.setCategoryIds(t)}})},[d]),o.useEffect(()=>{y([...u.selectors.InvoicesReducer.invoices])},[u.selectors.InvoicesReducer.invoices]);function E(e){const t=e;window.scrollTo(0,0),S(t)}c(E,"onDateChange");function R(e,t){console.log(t),h.actions.openDrawer(!0,a(I,{container:!0,style:{width:1100},children:a(A,{iua_id:t.iua.parent_iua_id,cmsMode:g,device:"desktop"})}),"right")}c(R,"clickItem");function T(e,t){const n=t.id,i=b.filter(P=>P.id==n)[0],k={pdf_id:i.blob.blob_id,subject:C(D,"SEND_MAIL_SUBJECT",i.number_string,i.month+"/"+i.year),body:`${window.env.BLOB_URL}/blob/${i.blob.blob_id}.pdf`};M.actions.openModal(!0,a(q,{...k}))}return c(T,"openInvoice"),a(I,{container:!0,style:{justifyContent:"center"},children:a(w,{isLoading:F,icons:f,freeActions:[s?a(G,{variant:"month",label:"Month",dateFormat:"MM/yyyy",showMonthYearPicker:!0,value:d,onChange:E}):a(Y,{})],...L({}),actions:[()=>({icon:f.OpenIn,label:"Open IUA",onClick:R}),()=>({icon:f.PictureAsPdf,label:"Open Invoice",onClick:T})],data:b.sort((e,t)=>new Date(t.createdAt)>new Date(e.createdAt)?1:-1).map(e=>({...e,info:{number:e.number}})),title:"Invoices List"})})}c(W,"InvoicesList");export{W as default};
