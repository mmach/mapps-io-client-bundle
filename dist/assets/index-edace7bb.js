var E=Object.defineProperty;var o=(l,s)=>E(l,"name",{value:s,configurable:!0});import{B as N,m as h,R as i,f as M,g as _,c as G,u as O,h as k,j as H,G as L,e as c,F as X,v as q}from"./index-06cc938e.js";class P extends N{constructor(){super(),this.blob=0,this.type=0,this.uid=""}decode(s){let d=decodeBase64Image(s);this.blob=d.data,this.type=d.type}getSize(s){return stringToBytesFaster(s.blob).length/1e3}}o(P,"BlobBase64DTO");function Q(l){const s=h.byName("mapps-component-dropzone").component,d=h.byName("mapps-component-body-loader").component,R=h.byName("mapps-component-button-loader").component,[u,A]=i.useState([]),[f,b]=i.useState(!1),[B,y]=i.useState([]),{selectors:{userProfileImageReducer:p=p},actions:{setLoading:v=v,uploadImage:F=F,getUserImages:w=w}}=M();_();const{selectors:{userProfileReducer:r=r},actions:{getUserInfo:x=x}}=G(),{getLabel:I,translate:S}=O(),{selectors:{authReducer:m=m},actions:{setAuthContext:z=z}}=k();i.useEffect(()=>{A(p.images)},[p.images]);const U=i.useMemo(()=>m.user.id==r.user.id,[r.user.id]);async function D(){let a=await x(r.user.id);a.data.id==m.user.id&&z(a.data)}o(D,"reloadAuthContext");const T=o(a=>{try{const t=[];for(let e=0;e<a.length;e++){const n=a[e],g=new window.FileReader;g.readAsDataURL(n),g.onload=()=>{const C={name:n.name,type:n.type,size:Math.round(n.size/1e3)+" kB",base64:g.result,file:n};t.push(C)}}y(t)}catch(t){console.error(t)}},"addImage");async function j(){b(!0);const a=B.map(t=>{const e=new P;return e.id=q(),e.blob=t.base64.split("base64,")[1],e.type=t.type,F(e)});await Promise.all(a),await w({user_id:r.user.id}),y([]),await D(),b(!1)}return o(j,"submitHanlder"),5-u.length>0&&U?H(L,{children:[f?c(L,{style:{height:"240px",display:"flex"},children:c(d,{text:" ",size:"25px"})}):c(s,{className:"mapps-user-images-upload-dropzone-area",onChange:T,filesLimit:5-u.length,dropzoneText:S(I,"USER_IMAGE_PROFILE_TEXT",5-u.length),acceptedFiles:["image/jpeg","image/png","image/bmp"],showPreviews:!1,maxFileSize:25e5,showAlerts:!0,useChipsForPreview:!1,showPreviewsInDropzone:!0,fileObjects:[]}),c(R,{onClick:j,size:"medium",color:"primary",className:"mapps-user-images-upload-button",value:S(I,"Save"),isLoading:f})]}):c(X,{})}o(Q,"AddProfileImage");export{Q as default};
